SELECT
@idpdam AS idpdam,
@id:=@id+1 as idrekeningair,
pel.idpelangganair AS idpelangganair,
per.idperiode AS idperiode,
COALESCE(gol.idgolongan,-1) AS idgolongan,
COALESCE(dia.iddiameter,-1) AS iddiameter,
1 AS idjenispipa,
1 AS idkwh,
ray.idrayon AS idrayon,
kel.idkelurahan AS idkelurahan,
kol.idkolektif AS idkolektif,
1 AS idadministrasilain,
1 AS idpemeliharaanlain,
1 AS idretribusilain,
p.status AS idstatus,
1 AS idflag,
rek.meter1 AS stanlalu,
IFNULL(rek.meter2, 0) AS stanskrg,
IFNULL(rek.stan_angkat, 0) AS stanangkat,
IFNULL(rek.pemakaian, 0) AS pakai,
IFNULL(rek.pemakaian, 0) AS pakaikalkulasi,
IFNULL(rek.hargaair, 0) AS biayapemakaian,
IFNULL(rek.byadm, 0) AS administrasi,
IFNULL(rek.danameter, 0) AS pemeliharaan,
0 AS retribusi,
0 AS pelayanan,
0 AS airlimbah,
0 AS dendapakai0,
0 AS administrasilain,
0 AS pemeliharaanlain,
0 AS retribusilain,
0 AS ppn,
0 AS meterai,
IFNULL((rek.jumlahbayar-rek.denda), 0) AS rekair,
IFNULL(rek.denda, 0) AS denda,
0 AS diskon,
0 AS deposit,
IFNULL(rek.jumlahbayar, 0) AS total,
0 AS hapussecaraakuntansi,
NULL AS waktuhapussecaraakuntansi,
NULL AS iddetailcyclepembacaan,
NULL AS tglpenentuanbaca,
hsl.sudahbaca AS flagbaca,
IF(hsl.sudahbaca=1, 4, NULL) AS metodebaca,
DATE(hsl.waktubaca)AS waktubaca,
TIME(hsl.waktubaca) AS jambaca,
hsl.kodepetugas AS petugasbaca,
IF(hsl.idkelainan=0, NULL, hsl.idkelainan) AS kelainan,
IFNULL(rek.meter2, 0) AS stanbaca,
DATE(hsl.waktuupload) AS waktukirimhasilbaca,
TIME(hsl.waktuupload) AS jamkirimhasilbaca,
hsl.memolapangan AS memolapangan,
hsl.lampiran AS lampiran,
0 AS taksasi,
hsl.taksir AS taksir,
0 AS flagrequestbacaulang,
NULL AS waktuupdaterequestbacaulang,
hsl.sudahbaca AS flagkoreksi,
DATE(hsl.waktubaca) AS waktukoreksi,
TIME(hsl.waktubaca) AS jamkoreksi,
hsl.verifikasi AS flagverifikasi,
DATE(hsl.waktuverifikasi) AS waktuverifikasi,
TIME(hsl.waktuverifikasi) AS jamverifikasi,
NULL AS userverifikasi,
1 AS flagpublish,
DATE(NOW())AS waktupublish,
DATE_FORMAT(NOW(), '%H:%i:%s')  AS jampublish,
NULL AS userpublish,
hsl.latitude AS latitude,
hsl.longitude AS longitude,
hsl.latitude AS latitudebulanlalu,
hsl.longitude AS longitudebulanlalu,
1 AS adafotometer,
0 AS adafotorumah,
0 AS adavideo,
0 AS flagminimumpakai,
hsl.pakai1 AS pakaibulanlalu,
hsl.pakai2 AS pakai2bulanlalu,
hsl.pakai3 AS pakai3bulanlalu,
0 AS pakai4bulanlalu,
hsl.persen1 AS persentasebulanlalu,
hsl.persen2 AS persentase2bulanlalu,
hsl.persen3 AS persentase3bulanlalu,
hsl.kelainanlalu AS kelainanbulanlalu,
NULL AS kelainan2bulanlalu,
0 AS flagangsur,
NULL AS idangsuran,
NULL AS idmodule,
0 AS flagkoreksibilling,
CONCAT(rek.periode2,'-',LPAD(rek.periode1,2,'0'),'-26') + INTERVAL 1 MONTH AS tglmulaidenda1,
CONCAT(rek.periode2,'-',LPAD(rek.periode1,2,'0'),'-26') + INTERVAL 1 MONTH AS tglmulaidenda2,
CONCAT(rek.periode2,'-',LPAD(rek.periode1,2,'0'),'-26') + INTERVAL 1 MONTH AS tglmulaidenda3,
CONCAT(rek.periode2,'-',LPAD(rek.periode1,2,'0'),'-26') + INTERVAL 1 MONTH AS tglmulaidenda4,
CONCAT(rek.periode2,'-',LPAD(rek.periode1,2,'0'),'-26') + INTERVAL 1 MONTH AS tglmulaidendaperbulan,
NULL AS tglmulaidendaperhari,
IF(hsl.sudahbaca=1, 1, NULL) AS flaghasbeenpublish,
0 AS flagdrdsusulan,
NULL AS waktudrdsusulan,
NOW() AS waktuupdate,
0 AS flaghapus
FROM t_penjualan rek
JOIN maros_awal.pelangganmaros pel ON pel.nosamb = rek.nosamb
JOIN maros_awal.periodemaros per ON per.kodeperiode = CONCAT(rek.periode2,LPAD(rek.periode1,2,'0'))
LEFT JOIN kabmaros_loket4.pelanggan p ON rek.nosamb=p.nosamb
LEFT JOIN maros_awal.golonganmaros gol ON gol.kodegolongan = rek.goltarif
LEFT JOIN maros_awal.diametermaros dia ON dia.kodediameter = p.kodediameter
LEFT JOIN maros_awal.rayonmaros ray ON ray.koderayon = p.koderayon
LEFT JOIN maros_awal.kelurahanmaros kel ON kel.kodekelurahan = p.kodekelurahan
LEFT JOIN maros_awal.kolektifmaros kol ON kol.kodekolektif = p.kodekolektif
LEFT JOIN `maros_awal`.`t_ptgs_met` ptgs ON ptgs.id_ptgs_met=rek.ptgs_met
LEFT JOIN `bacameter_maros`.hasilbaca0525 hsl ON hsl.idpelanggan=rek.nosamb
,(select @id:=@lastid) as id
WHERE rek.`PERIODE2`='2025' AND rek.`PERIODE1`='5'
AND pel.`idpelangganair` IN (
26, 73, 134, 149, 159, 269, 312, 352, 531, 638, 643, 660, 668, 857, 863, 943, 954, 1165, 1223, 1499, 1530, 1632, 1669, 1742, 1952, 2402, 2518, 2900, 3140, 3200, 3228, 3355, 3457, 3458, 3554, 3594, 3687, 3765, 4081, 4106, 4697, 5178, 5236, 5273, 5317, 5336, 5344, 5361, 5386, 5732, 5781, 6110, 6195, 6344, 6345, 6397, 6425, 6642, 6653, 6954, 6986, 7140, 7181, 7268, 7548, 7596, 7824, 7869, 7908, 7925, 7977, 8086, 8114, 8301, 8344, 8459, 8460, 8673, 8828, 8843, 9004, 9074, 9092, 9105, 9143, 9145, 9158, 9384, 9765, 9872, 10067, 10168, 10448, 10475, 10503, 10684, 11134, 11173, 11196, 11213, 11399, 11446, 11729, 11801, 11894, 11917, 12184, 12240, 12242, 12272, 12285, 12498, 12626, 12666, 12682, 12756, 13063, 13113, 13118, 13335, 13370, 13371, 13389, 13406, 13472, 13562, 13704, 13733, 13752, 13801, 13808, 13881, 13882, 13923, 13947, 14011, 14012, 14028, 14132, 14314, 14315, 14376, 14400, 14507, 14625, 14651, 14686, 14703, 14814, 15017, 15021, 15074, 15115, 15250, 15292, 15392, 15404, 15447, 15458, 15677, 15779, 15855, 15873, 16007, 16022, 16023, 16210, 16408, 16512, 17120, 17137, 17334, 17399, 17483, 17559, 17577, 17587, 17628, 17653, 17676, 17689, 17772, 17913, 18007, 18029, 18055, 18071, 18073, 18111, 18116, 18144, 18146, 18210, 18230, 18231, 18241, 18674, 18677, 18784, 18817, 18981, 19112, 19200, 19248, 19254, 19305, 19340, 19395, 19405, 19434, 19478, 19480, 19494, 19518, 19680, 19778, 19801, 20015, 20016, 20524, 20610, 20635, 20855, 20908, 20924, 21044, 21114, 21232, 21316, 21337, 21384, 21390, 21391, 21477, 21491, 21509, 21558, 21725, 21859, 21867, 21912, 21947, 22010, 22072, 22288, 22356, 22709, 22710, 22727, 22843, 23164, 23185, 23290, 23326, 23457, 23526, 23600, 23663, 23692, 23707, 23718, 23744, 23755, 23779, 23793, 23856, 23896, 23923, 24003, 24033, 24060, 24109, 24113, 24114, 24124, 24136, 24262, 24318, 24448, 24449, 24550
)
