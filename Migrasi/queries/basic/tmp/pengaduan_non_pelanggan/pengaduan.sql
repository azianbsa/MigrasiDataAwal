SET @tgladu_awal='2014-01-04';
SET @tgladu_akhir='2025-07-02';

SELECT
@idpdam AS idpdam,
a.`idpermohonan` AS idpermohonan,
t.`idtipepermohonan` AS idtipepermohonan,
COALESCE(s.`idsumberpengaduan`,1) AS idsumberpengaduan,
CONCAT(noadu,DATE_FORMAT(tgladu,'%Y%m%d'),REPLACE(jamadu,':','')) AS nomorpermohonan,
COALESCE(a.`tgladu`,' ',a.`jamadu`) AS waktupermohonan,
0 AS flagpendaftaran,
NULL AS idtipependaftaransambungan,
a.`nama` AS nama,
a.`alamat` AS alamat,
NULL AS idgolongan,
NULL AS iddiameter,
NULL AS idrayon,
NULL AS idkelurahan,
NULL AS idblok,
NULL AS idperuntukan,
NULL AS idjenisbangunan,
NULL AS idkepemilikan,
NULL AS idpekerjaan,
NULL AS idkolektif,
NULL AS idsumberair,
NULL AS iddma,
NULL AS iddmz,
NULL AS idmerekmeter,
NULL AS idkondisimeter,
NULL AS idadministrasilain,
NULL AS idpemeliharaanlain,
NULL AS idretribusilain,
NULL AS noserimeter,
NULL AS tglmeter,
NULL AS urutanbaca,
NULL AS stanawalpasang,
a.`telp` AS notelp,
NULL AS email,
NULL AS noktp,
NULL AS nokk,
NULL AS kodepost,
NULL AS dayalistrik,
NULL AS luastanah,
NULL AS luasrumah,
NULL AS rt,
NULL AS rw,
a.`telp` AS nohp,
a.`uraian` AS keterangan,
NULL AS nosambyangdiberikan,
NULL AS nosambdepan,
NULL AS nosambbelakang,
NULL AS nosambkiri,
NULL AS nosambkanan,
0 AS penghuni,
NULL AS namapemilik,
NULL AS alamatpemilik,
COALESCE(u.`iduser`,-1) AS iduser,
NULL AS idnonair,
SUBSTRING_INDEX(a.`k_lat_long`,';',1) AS latitude,
SUBSTRING_INDEX(a.`k_lat_long`,';',-1) AS longitude,
NULL AS alamatmap,
0 AS flagverifikasi,
NULL AS waktuverifikasi,
0 AS flagpelanggankavlingan,
0 AS flaghapus,
a.`tgladu` AS waktuupdate,
NULL AS airyangdigunakansebelumnya,
IF(a.`tgltl` IS NOT NULL,'Selesai',NULL) AS statuspermohonan
FROM `pengaduannonplg` a
JOIN `maros_awal`.`tipepermohonan` t ON t.`kodejenisnonair`=a.`jns`
LEFT JOIN `maros_awal`.`sumberpengaduanmaros` s ON s.`namasumberpengaduan`=a.via
LEFT JOIN `maros_awal`.`usermaros` u ON u.`nama`=a.`nmuseradu`
WHERE a.idpermohonan=5114
-- a.`tgladu`>=@tgladu_awal
-- AND a.`tgladu`<@tgladu_akhir